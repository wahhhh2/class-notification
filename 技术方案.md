# 班级通知网页技术方案

## 项目概述
基于URL参数传递消息的纯前端班级通知网页，支持微信消息接收和本地存储。

## 技术架构

### 整体架构
```
微信消息 → URL参数 → 前端网页 → localStorage → 界面显示
```

### 技术栈
- **前端框架**：原生HTML5 + CSS3 + JavaScript (ES6+)
- **数据存储**：浏览器localStorage
- **消息传递**：URL查询参数
- **部署方式**：本地文件或GitHub Pages

## 详细技术实现

### 1. 消息接收机制

#### URL参数格式
```
http://localhost/notify.html?message=内容&sender=发送者&time=时间戳
```

#### 参数说明
- `message`：消息内容（必需）
- `sender`：发送者名称（可选，默认"未知"）
- `time`：时间戳（可选，默认当前时间）

#### JavaScript解析代码
```javascript
function getUrlParams() {
    const urlParams = new URLSearchParams(window.location.search);
    return {
        message: urlParams.get('message') || '',
        sender: urlParams.get('sender') || '未知',
        time: urlParams.get('time') || Date.now()
    };
}
```

### 2. 数据存储设计

#### 数据结构
```javascript
{
    messages: [
        {
            id: 1640995200000, // 时间戳作为唯一ID
            content: "明天放假",
            sender: "班主任",
            timestamp: 1640995200000,
            receivedAt: "2024-01-01 08:00:00"
        }
    ],
    settings: {
        maxMessages: 100, // 最大存储消息数
        autoClean: true   // 自动清理旧消息
    }
}
```

#### 存储操作API
```javascript
class MessageStorage {
    // 保存消息到localStorage
    saveMessage(message) {
        const messages = this.getMessages();
        messages.push({
            id: Date.now(),
            content: message.content,
            sender: message.sender,
            timestamp: message.time,
            receivedAt: new Date().toLocaleString('zh-CN')
        });
        
        // 限制消息数量
        if (messages.length > 100) {
            messages.shift(); // 移除最旧的消息
        }
        
        localStorage.setItem('class_notifications', JSON.stringify(messages));
    }
    
    // 获取所有消息
    getMessages() {
        return JSON.parse(localStorage.getItem('class_notifications') || '[]');
    }
    
    // 清空所有消息
    clearMessages() {
        localStorage.removeItem('class_notifications');
    }
}
```

### 3. 界面设计

#### 页面结构
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>班级通知</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>班级通知</h1>
            <button id="clearBtn">清空消息</button>
        </header>
        
        <div class="message-list" id="messageList">
            <!-- 消息列表动态生成 -->
        </div>
        
        <div class="help-section">
            <h3>如何使用？</h3>
            <p>在微信中发送包含消息的链接：</p>
            <code>http://你的网址/notify.html?message=内容&sender=发送者</code>
        </div>
    </div>
    
    <script src="app.js"></script>
</body>
</html>
```

#### 样式设计（CSS）
```css
/* 响应式设计，适配手机端 */
.container {
    max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.message-item {
    background: #f5f5f5;
    border-left: 4px solid #007bff;
    padding: 15px;
    margin: 10px 0;
    border-radius: 5px;
}

.message-sender {
    font-weight: bold;
    color: #333;
}

.message-content {
    margin: 10px 0;
    color: #666;
}

.message-time {
    font-size: 0.8em;
    color: #999;
}
```

### 4. 核心功能流程

#### 页面加载流程
1. 解析URL参数
2. 如果有新消息，保存到localStorage
3. 从localStorage加载历史消息
4. 渲染消息列表到界面

#### 消息处理流程
```javascript
// 页面加载时执行
window.addEventListener('load', function() {
    const storage = new MessageStorage();
    const params = getUrlParams();
    
    // 如果有新消息
    if (params.message) {
        storage.saveMessage(params);
        // 清空URL参数，避免重复添加
        window.history.replaceState({}, document.title, window.location.pathname);
    }
    
    // 显示消息列表
    displayMessages(storage.getMessages());
});
```

## 微信适配方案

### 微信内使用说明
1. **链接构造**：在微信中构造包含消息的URL
2. **消息发送**：将链接发送给班级群或个人
3. **消息查看**：点击链接自动显示消息内容

### 示例消息格式
```
各位同学：明天上午9点开班会，请准时参加。

点击查看：http://localhost/notify.html?message=明天上午9点开班会，请准时参加&sender=班主任
```

## 部署方案

### 方案1：本地运行（最简单）
- 直接双击HTML文件在浏览器中打开
- 使用`file://`协议访问
- 限制：某些浏览器可能限制localStorage使用

### 方案2：GitHub Pages（推荐）
- 免费托管在GitHub
- 支持HTTPS，微信内访问更安全
- 可通过自定义域名访问

### 方案3：本地HTTP服务器
```bash
# 使用Python简单服务器
python -m http.server 8000

# 或使用Node.js http-server
npx http-server -p 8000
```

## 技术风险评估

### 风险点及应对
1. **浏览器兼容性**
   - 风险：低 - 现代浏览器都支持所需API
   - 应对：使用标准API，测试主流浏览器

2. **localStorage限制**
   - 风险：中 - 单个域名存储限制约5MB
   - 应对：设置消息数量上限（100条）

3. **URL长度限制**
   - 风险：中 - 不同浏览器URL长度限制不同
   - 应对：限制单条消息长度（建议<2000字符）

## 测试方案

### 功能测试清单
- [ ] URL参数解析正确
- [ ] 消息保存到localStorage
- [ ] 消息列表正确显示
- [ ] 清空消息功能正常
- [ ] 消息数量限制生效
- [ ] 响应式设计适配手机
- [ ] 微信内链接正常打开

### 性能测试
- 消息加载时间 < 100ms
- 同时显示100条消息不卡顿
- 内存占用合理

## 后续扩展可能

### 功能扩展（可选）
1. **消息分类**：按发送者或类型分类
2. **消息搜索**：关键词搜索功能
3. **消息导出**：导出为文本文件
4. **消息提醒**：浏览器通知提醒

### 技术升级（可选）
1. **PWA支持**：添加为桌面应用
2. **Service Worker**：离线缓存支持
3. **IndexedDB**：更大容量存储

---

## 审核要点
请审核以下关键点：
1. 技术方案是否满足所有需求
2. 微信适配方案是否可行
3. 数据存储方案是否合理
4. 界面设计是否简洁易用
5. 部署方案是否简单可行

审核通过后即可开始开发。